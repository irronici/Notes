## 02 文本编码

[toc]

### ASCII

+ 96个可打印字符+32个控制字符
+ 用7位二进制进行编码

### 汉字的编码

GB2312, GB12345（含繁体）, CJK（中日韩统一汉字字符集）,  GBK, BIG5

### UCS体系结构

<img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20200306153023631.png" alt="image-20200306153023631" style="zoom:50%;" />

+ 目前只用了17个平面，即到01平面
+ 每个平面放65536=256*256个字符
+ 第00组00平面被称为基本多文种平面(Basic Multilingual Plane, BMP)
+ 对应的软件产品为Unicode

### UTF-8（UCS Transformation Form - 8）

+  **变长编码**

+  为与原8-bit系统向下兼容，UCS采用单字节表示ASCII字符，这种可变长编码被称为 *UTF-8*

+  可用1/2/3/4个字节来编码

+ **UCS to UFT-8**

  <img src="C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20200306163856907.png" alt="image-20200306163856907" style="zoom:80%;" />
  
  + **转换为utf-8字符流后，如何判断该字符流占几个字节：**
    + 要拆成一个一个字节来看，先读一个字节：
      + 最高位为0，就表示一个字节的字符
      + 最高比特是1，就看有几个连续的1，有几个1就是表示几个字节表示的字符

### UTF-16

+ **变长编码**

+ 不考虑与ASCII兼容，在UCS文本中还允许使用4字节的UCS-4字符，扩大字符集容量。用 *行号×字位号* 表示字符

+ 在BMP平面保留了2个有1024位置的块(D800~DFFF)

+ UTF-16还可以利用保留下来的0xD800-0xDFFF区段的码位来对“辅助平面”的字符的码位进行编码，因此UTF-16可以为Unicode中所有的字符编码。

+ **UCS to UTF-16**

  令字符x的UCS表示为a，UTF-16形式表示为b

  1. a-0x10000	(减去BMP的字符数，十进制的65536)
  2. 转换为20bits数，高位不够补0，并分成高10bits，低10bits
  3. 将高10bits与D800（1101 1000 0000 0000）相加（拓展到D800位置的块上）
  4. 将低10bits与DC00（1101 1100 0000 0000）相加
  
  + **转换为utf-16字符流后，如何判断该字符流占几个字节：**
  
    + 两个字节两个字节地判断，先读两个字节：
  
      + 若小于D800 **或者** 大于DFFF的那么就是一个两字节的编码
  
        若大于D800 **且** 小于DFFFF（DC00）的那么就是一个四字节的编码，那就再读两个字节

### 小结

编码字符集按某种规则编码的字符的有序集合，每个编码字符集有三个最重要的属性：

+ 字汇：编码字符集中有哪些字符
+ 编码规则：如何确定每个字符的代码
+ 码长：字符代码的长度。（决定了代码空间的大小）